Добрались до интересного. Скажу сразу, чужих реализаций я не смотрел, писал по наитию, опираясь на статью из википедии. Получился неплохой результат. Как я уже говорил, в большинстве случаев, при большой длине текста, мой алгоритм угадывает смещение. Очень слабое место это переменная , которая отвечает за интервал, в который нужно попасть символу. И функция получилась очень уж громоздкой, у меня есть подозрения, что на Питоне можно было написать покороче. Но, в любом случае, она работает.